<!DOCTYPE html>
<html>
<head>
  <title>Evolution simulator</title>
</head>
<body>
  <h1 style="text-align:center; margin-right: 300px; margin-left: 300px; font-family: Arial;">Evolution simulator</h1>
  <h2 style="text-align:center; margin-right: 300px; margin-left: 300px; font-family: Arial; font-size: 130%;">An approach to how evolution and natural selection works with R</h2>
  <h2 style="text-align:center; margin-right: 300px; margin-left: 300px; font-family: Arial; font-size: 110%;">Marc Vez Garzón, January 2023</h2>

  <p style="margin-right: 300px; margin-left: 300px; margin-top: 50px; font-family: Arial; text-align:justify; margin-bottom: 50px;">In this HTML, I will show a simple approach to the concept of evolution. First, I will quickly explain how evolution works and which parameters play a role in natural selection. Then, I will explain how this simulation works, which parameters does it take into account and how it imitates an evolutionary process. Finally, I will show and discuss some examples. The simulation is simple, but I think it can be useful to understand how evolution works.</p>

<h2 style="text-align:center; font-family: Arial; font-size: 110%;">How evolution works</h2>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">We could define evolution like the process by which living beings gradually transform and become new species, different from their ancestors and the rest of living beings. The mechanism that makes this process possible is natural selection. It was defined by Darwin like "the survival of the fittest". This means that only the individuals that best adapt to their current environment are the ones that survive and reproduce. Being able to adapt to your environment means that you possess the needed characteristics to overcome challenges (e.g., being able to scape from predators by possessing slightly larger limbs than your conspecifics, developing larger horns than the rest of opponents opting to reproduce, or being able to detect predators before the rest of individuals). Being the fittest means that there has to be someone that performs worse than you, and that is possible due to the fact that in nature diversity among individuals exist. If diversity among individuals exist, the efficiency of a certain trait in front of a challenge can be tested. Only the ones that perform the best are the ones that survive and reproduce.</p>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">Heritage is another important factor in evolution. The descendants of two progenitors look alike their parents. Characteristics and traits from the parents are transferred to their descendants, and the mechanism that regulates this process is DNA. The information needed to develop and express any trait is contained in a DNA sequence, formed by four different nucleotides. When reproducing, the DNA sequences of both parents mix and create a new and unique combination of nucleotides, which is the DNA sequence of their future child. This unique DNA sequence contains the information on how to develop each trait on a new individual. The development of these traits is going to be similar to their parents' trait development, as the information required to create this new and unique DNA sequence comes from the mix of both parents DNA sequences. Although this process has been highly optimized through evolution, some errors (called mutations) can happen when copying the information of the DNA sequences of each parent in their sexual cells. These mutations make the copying system not 100% accurate, but adds diversity and variability to evolution. Most mutations are not either good or bad, but neutrals. When mutations are not neutral, they alter the trait development, making the resulting trait slightly better or slightly worse than the previous version of that trait.</p>

  <p style="margin-right: 300px; margin-left: 300px; margin-bottom: 50px; font-family: Arial; text-align:justify;">Then, when combining both concepts (the survival of the fittest and the "almost-100%-accurate" heritage process), evolution can happen. Only the best suited for the environment and the challenges that it can present are the ones that survive and reproduce. When reproducing, their genetic information is going to be mixed, and the resulting mix is going to determine the aptitude of their descendant. This descendant contains the trait development of two very well suited individuals that were able to survive and reproduce in their environment. Thus, the descendant is likely to perform well in the same environment, as their parents did. Generation after generation, this selection of the fittest occurs, optimizing in each generation the traits that allow individuals to adapt to their environment and be better than the rest of the opponents. The role of mutation in this process is also important, but I am going to talk about its role later with the examples. </p>

  <h2 style="text-align:center; font-family: Arial; font-size: 110%;">How the simulation works</h2>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In order to simulate this process, two dots are always going to be displayed on the "developmenal canvas": one as the starting point of the development of a certain trait (black dot), and the other as the most optimized version of that exact trait (red dot). In order to survive and reproduce, the development of our trait has to end the closer that it can to the optimized version of the trait, always starting the development from the same spot. At each step of the development, any of the 8 possible directions can be taken. Some of these directions approach the development of the trait to the optimum trait conformation, some others are neutrals, and some direct the development of the trait towards non optimal conformations. This process is going to be done a finite number of times (steps), like an embrionary development process. At the end of these finite number of steps, it is considered that the developmental process is complete, and the resulting trait conformation is the one that is going to be compared among individuals in relation to the optimal trait conformation. Only the closest to the optimal trait conformation (best suited to overcome the challanges that the environment present through the expression of this trait) are the ones that will reproduce and pass their "genetic information" (the followed path) to their descendance.</p>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">During the first generation, all individuals are going to move around the "developmental canvas" randomly, as they do not know which is the optimal development of the trait we want to optimize. Only when the first generation finishes their development and the fittest reproduce, they will know towards where their development should go. They do not know where to go because we tell them where should they go, but because they follow the path of their ancestors, that were the ones that got randomly closer to the optimal trait conformation. This process goes on for a finite number of generations, with each generation getting closer to the optimal trait conformation than the previous one.</p>

  <p style="margin-right: 300px; margin-left: 300px; margin-bottom: 50px; font-family: Arial; text-align:justify;">The way "genetic information" passes between parents and descendants works similarly as sexual reproduction works. The paths followed by the fittest individuals at each developmental step get into a genetic pool. Each descendant, for each developmental step, randomly takes one of these directions from the genetic pool. For exemple, if 9 out of the fittest 10 individuals went right at the first developmental step, the probability of the descendant to go right on the firtst developmental step is 9/10. It can happen that, at the moment of taking one of the directions taken by its parents, a mutation occurs. Insted of going on the developmental direction taken by the fittest individuals, the developmental path goes to any of the 8 possible directions. This mutation can seem to be bad for individuals, as insteed of directing the trait development to the right direction, the mutation can lead the developmental process to a not-optimal direction. We will see that, although this is true, mutations can be very beneficial for individuals when the environment is not constant in time, as mutations add variability to the population and could save the species from extintion in front of an environmental change.</p>

  <h2 style="text-align:center; font-family: Arial; font-size: 110%;">Some examples: mutation rate</h2>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In this first example, we can see a simulation where during 100 generations, 100 individuals per generation try to reach the optimal trait conformation during a 50 steps developmental process. In this simulation, the mutation rate is 5%, and the percentage of individuals that reproduce and contribute to next generation genetic pool is 50% (i.e., only the best half of individuals reproduce: the ones that got closer to the optimal trait conformation). You can see how on the first generation, the paths followed by the individuals is random. Once the first generation reproduces, the road for the next generation is set. It can be seen how as from generation 20 onwards, the improvement in trait development does not increase much (i.e., distance from final trait conformation to optimal conformation). That is because although only the best reproduce, mutations occur. This makes the process not 100% optimal, but increases variability among individuals, which is good for the species on the long term, as we will see. Even mutations occur, some individuals are able to reach the optimal trait conformation through one of the multiple development paths that could be taken during the whole developmental process.</p>

<div style="text-align:center;">
  <img <img src="https://imgur.com/4AGdGaF.gif" alt="Simulation 1" style="display:block; margin:auto;">
</div>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In this second exemple, all parameters stay the same as in the first simulation, except the mutation rate. Now, the mutation rate is set to 0%. As you see in the simulation, individuals reach the almost-optimal trait conformation area faster than in the first simulation, around the 10th generation. You can also see that the number of taken paths by the individuals are less than in the first simulation. Around the 75th generation, all individuals develop the same and reach the optimal trait conformation. That is good, right? Well, although it may be good for the individuals, as they perform the best for what is required in their environment for that specific trait, it may also present some drawbacks. In this second simulation, variability among individuals has been erased. All individuals develop the same and reach the same trait conformation at the same time. But what would happen if their environment change and the optimal trait conformation to face this new environment changes too? Now, all these individuals that develop the same are going to not perform the best for their new environment, and there is nothing they can do about to change this situation. The abscense of mutations, althoug allowing the population to reach the optimal trait conformation faster, can make them vulnerable to environmental changes that alter the required trait conformation to face the new conditions.</p>

  <p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">This later situation is what would happen with individuals that reproduce assexualy. These types of organisms can be very successful in stable environments, reproducing at an incredible rate, but they do not perform well in stochastic and variable environments. As in this simulation they do not mutate, they cannot react to these novel conditions, and in this simulation they would have to wait for a new individual from outside the colony to introduce its genetic information (taken path) into the genetic pool. The mix of information that occurs during sexual reproduccion acts like a kind of mutation episode, as the exact information from both progenitors cannnot be copyied on the new single DNA sequence of their descendant. Even if the sexual reproduction population had no genetic diversity and all individuals developed the same, some mutations would still occur. That would make the population able to react and adapt to the new environmental conditions, if these got to change the optimal trait conformation required to perform the best on this new environment.</p>

<div style="text-align:center; margin-bottom: 50px;">
  <img src="https://imgur.com/tJMFOiG.gif" alt="Simulation 2" style="display:block; margin:auto;">
</div>

 <h2 style="text-align:center; font-family: Arial; font-size: 110%;">Some examples: Reproductive population</h2>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">What would happen if insted of modifying the mutation rate, we changed the proportion of individuals that reproduce at the end of the developmental process? The ones that reproduce are the fittest and the ones that perform the best on that specific environment. Then, if we reduce the % of individuals that reproduce (i.e., the fittest among the fittest), we should expect an even faster natural seection towards the desired optimal trait conformation, right? That is exactly what we see in the following simulation.</p>

<div style="text-align:center;">
  <img src="https://imgur.com/W3gZgN2.gif" alt="Simulation 3" style="display:block; margin:auto;">
</div>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">The parameters on this simulation are the same as in the first simulation, except the % of indidivuals that reproduce on each generation. In this simulation, it has been set from 50% of the population to only 10% of the population. As you can see, the individuals reach the area close to the optimal trait conformation in less generations that in the first simulation. It can also be seen how from generation 15th onwards, in almost each generation there are some individuals that reach the optimal trait conformation. Unlike in the second simulation where all individuals behaved the same (i.e., population with a 0% mutation rate), in this simulation the path followed by indidivuals that reach the optimal trait conformation is different in every generation. This means that even a lot of indidivuals reach the desired trait conformation, there is variability among individuals during the process, which would allow the population to react if an environmental change modified the optimal trait conformation.</p>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In the same way reducing the % of individuals that reproduce accelerates natural selection, increasing the % slows down evolution. See how on the following simulation, even if the overall direction taken by indidivuals is correct, they do not get as close to the optimal trait conformation as in previous simulations.</p>

<div style="text-align:center;">
  <img src="https://imgur.com/1fO3HaM.gif" alt="Simulation 4" style="display:block; margin:auto;">
</div>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">And what would happen to a population with a mutation rate of 0% where only 10% of the population reproduce? As you see in the simulation below, natural selection filters one of the possible paths to reach the optimal trait conformation very quick. In less than 20 generations, the path is set, and all individuals behave the same, with no variation among individuals at all. </p>

<div style="text-align:center;">
  <img src="https://imgur.com/5uXzPVx.gif" alt="Simulation 5" style="display:block; margin:auto;">
</div>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">With these examples, we can see how the % of individuals that reproduce in each generation does have an effect on natural selection and evolution. This would be the case of species with sexual dimorfism and competition between individuals of the same sex to get access to the other sex and reproduce. Very few of the contestants are able to reproduce on each generation, and their genes will be very likely to be passed to their descendants. If they were able to reproduce, that means that they possesed the best qualities or traits to beat their contestants and reproduce, so these specific traits are the ones under selection and the ones that will tend to be optimized. As the number of individuals that reproduce is very low, variability in developmental paths is also low. Natural selection is faster and stronger, as only the fittest of the fittest are the ones that reproduce and contribute to the genetic pool.</p>


<p style="margin-right: 300px; margin-left: 300px; margin-bottom: 50px; font-family: Arial; text-align:justify;">One extreme example of this is the artificial selection of dog breeds. The inbreeding between individuals that possessed the disered qualities did accelerate the evolution towards all the different breeds of dog that we can observe at the present time. Imagine that we wanted a dog breed with long ears (i.e., our developmental goal would be the red dot from the simulation). From a natural population (1st generation, very diverse), we would take the ones with the longest ears and make them reproduce. If we repeated this process for some generations, inbreeding the descendants with their brothers and sisters and parents, we would end having a dog breed with long ears, as we only allowed the dogs with the longest ears from each generation to reproduce (i.e., artificially restricting the % ofindividuals that reproduce). The bad thing about this process is that the genetic information variability would be reduced on every generation, as the gens that enter the genetic pool are always the same. This would look like our simulations with no variability among individuals. All the paths (i.e., genetic information) would be the same. Imagine that this path passed through a zone in our "developmental canvas" that made individuals die younger than the rest of their natural conspecifics when the developmental process passes through that zone. Now, all individuals would die younger than their coespecifics from a natural population. Inbreeding, therefore, can accelerate natural selection to the required trait conformation, at the cost of genetic variability, adaptation capabilities and possible hereditary conditions.</p>

 <h2 style="text-align:center; font-family: Arial; font-size: 110%;">Some examples: Environmental change</h2>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">We have been talking about how a population with no mutations can reach the optimal trait confirmation faster than populations with mutations, at the cost of being susceptible to environmental changes. Can the simulation reflect this behaviour? Now imagine that at half of the simulation, the environment changed and the trait requirements needed to face this new environment also changed. Which population would be better? In the next two simulations you will see how at the 51th generation, the optimal trait conformation (i.e., the red point), changes its position, due to an environmental change. In the first simulation, the population has a mutation rate of 5%, and in the second simulation, a mutation rate of 0.1%. Make your guess!</p>

<div style="text-align:center;">
  <img src="https://imgur.com/1hKbHSJ.gif" alt="Simulation 6" style="display:block; margin:auto;">
</div>

<div style="text-align:center;">
  <img src="https://imgur.com/d42Gxzv.gif" alt="Simulation 7" style="display:block; margin:auto;">
</div>

<p style="margin-right: 300px; margin-left: 300px; margin-bottom: 50px; font-family: Arial; text-align:justify;">It can be seen see how although the simulation with a 5% mutation rate does not reach the optimal trait conformation on the first half as good and fast as the population with 0.1% mutation rate, it is able to react to the environmental change better than the latter. This quality makes the first population more adaptable to changing environments than the second one. Variability among indivuals is, therefore, important to adaptability and natural selection. Variability allows population to react in front of new environmental requirements, and it is also the key factor that vertebrates natural selection.</p>

 <h2 style="text-align:center; font-family: Arial; font-size: 110%;">Summary</h2>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In this document, it can be seen how important variability and mutations are for the species, as well as the reproductive population. Natural selection acts over the traits that benefits the most the individuals and allow them to survive and reproduce. Natural selection does not know where the evolution of the species should go to, but knows which strategies work the best for a specific context. Natural selection rewards those individuals that best adapt to their current environment, and the genetic information of these successful individuals is the information that next generation individuals are going to use as a basis. Is through these mechanisms that natural selection can act and procuce evolutionary events.</p>

<p style="margin-right: 300px; margin-left: 300px; font-family: Arial; text-align:justify;">In these simulations, we have only tested how natural selection would act over an specific trait under certain circumstances, but natural selection has act on every aspect of our life history. Some traits may mutate more or be more different among individuals when these traits are useful to cope with environmental change and unpredicability. Some others, on the other hand, may be almost the same among individuals, with very few differences in their developmental path or final conformation, as these would be key traits that ensure the individual survival and reproductive output. Through the survival of the fittest, natural selection shapes the evolution of all living beings. Evolution, as in this simulation, is blind, and the behaviour that we observe on each trait has been selected over milions of years to act like it does in order to maximize the survival and reproduction of the individuals.</p>

<p style="margin-right: 300px; margin-left: 300px; margin-top: 100px; font-family: Arial; text-align:right;">2023, Marc Vez Garzón</p>



</body>
</html>
